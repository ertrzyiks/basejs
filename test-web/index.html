<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Basejs test</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

		<style>
		 .red{ color:red; }
		 .green{ color:green; }
		</style>
        <script src="../base.js"></script>
    </head>
    <body>
        <h3>Tests</h3>
		<ul>
		<script>
			//Just basic tests, for more advanced see 
			//test/test-inheritance.js
			function assert(condition, message){
				var result;
				
				if(condition){
					result = "<span class=\"green\">Ok</span>";
				}
				else{
					result = "<span class=\"red\">Fail</span>";
				}
				document.write("<li>" + message + ": " + result +"</li>");
			}
			
			assert.throws = function( message, task ){
				var thrown = false;
				
				try{
					task();
				}
				catch(e){
					thrown = true;
				}
				
				this(thrown, message);
			};
			
			assert.doesNotThrow = function( message, task ){
				var thrown = false;
				
				try{
					task();
				}
				catch(e){
					thrown = true;
				}
				
				this(!thrown, message);
			};
			
			var MyClass = Base.extend({
				test1: 1,
				
				testMethod: function(){
					return "123";
				}
			});
			
			
			var myObject = new MyClass();
			
			assert( myObject.test1 === 1, "Simple property");
			assert( 'testMethod' in myObject, "Method definition");
			assert( myObject.testMethod() === "123", "Method call");
			
			var MyClass2 = Base.extend({}, {
				test2: 1.0,
				
				testMethod: function(){
					return "123";
				}
			});
			
			assert( MyClass2.test2 === 1.0, "Simple static property");
			assert( 'testMethod' in MyClass2, "Static method definition");
			assert( MyClass2.testMethod() === "123", "Static method call");
			
			
			var iFace1 = Base.extend({
				counter: 0,
				
				run: function(){},
				
				pause: function(){},
				unpause: function(){}
			});
			
			var iFace2 = Base.extend({
				init: function(){}
			});
			
			assert.throws('Throw exception when interface member is not implemented', function(){
				Base.implement(iFace1).extend({
				});
			} );
				
			assert.throws('Throw exception when member from one of interfaces is not implemented', function(){
				Base.implement(iFace1).implement(iFace2).extend({
					counter: 0,
				
					init: function(){},
					
					pause: function(){},
					unpause: function(){}
				});
			} );
			
			assert.doesNotThrow('Implement members of interface', function(){
				Base.implement( iFace1 ).extend({
					counter: 0,
				
					run: function(){},
				
					pause: function(){},
					unpause: function(){}
				});
			} );
				
			assert.doesNotThrow( "Implement members of multiple interfaces", function(){
				Base.implement( iFace1 ).implement( iFace2 ).extend({
					counter: 0,
					
					init: function(){},
					run: function(){},
					
					pause: function(){},
					unpause: function(){}
				});
			} );
			
			
			
			var Mixin = Base.extend(
				{
					testing1: true
				},
				{
					testing1: true
				}
			);
			
			var Mixin2 = Base.extend(
				{
					testing3: true
				},
				{
					testing3: true
				}
			);
			
			var Class1 = Base.use(Mixin).use(Mixin2).extend(
				{
					testing2:  false
				},
				{
					testing2:  false
				}
			);
			
			var o = new Class1();
			
			assert( o.testing1 === true && o.testing2 === false && o.testing3 === true, "Mixin prototype property");
			assert( Class1.testing1 === true && Class1.testing2 === false && Class1.testing3 === true, "Mixin static property");
		</script>
		</ul>
    </body>
</html>
